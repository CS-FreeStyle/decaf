#!/bin/bash

TEST_NAME="@TESTNAME@"
RUN="./run"
CMP="diff -w"

SRCFILE=${TEST_NAME}.@TESTEXT@
INFILE=${TEST_NAME}.in
REFFILE=${TEST_NAME}.out
OUTFILE=${TEST_NAME}.put

RETVAL=0

echo
echo "------ BEGIN test $TEST_NAME ------"

if [ ! -x $INFILE ]; then
  $RUN $SRCFILE > $OUTFILE 2>&1
else
  $RUN $SRCFILE < $INFILE > $OUTFILE 2>&1
fi


if ${CMP} $OUTFILE $REFFILE; then
  :
else
  echo "Output differs from reference file"
  RETVAL=1
fi

exit $RETVAL
